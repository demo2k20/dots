#!/bin/sh

# Test for batteries
battery=$(du -h /sys/class/power_supply/* | grep "BAT*")

# Exit if there are no batteries
if [ -z "$battery" ]; then
    printf "No batteries found.\n"
    exit 0
fi

# Get battery status and capacity
status=$(cat /sys/class/power_supply/BAT0/status)
capacity=$(cat /sys/class/power_supply/BAT0/capacity)

# Choose an icon based on power state
if [ "$status" = "Charging" ]; then
    icon=""
elif [ "$status" = "Discharging" ]; then
    icon=""
elif [ "$status" = "Not charging" ]; then
    icon=""
fi

# Send a warning notification if below set threshold
if [ "$capacity" -lt 15 -a "$status" = "Discharging" ]; then
    notify-send -u critical "BATTERY LOW!"
fi

# Print result
printf "$icon $capacity%%\n"
