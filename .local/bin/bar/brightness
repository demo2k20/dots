#!/bin/sh

# Test for batteries (to see if it's a laptop)
BATTERY=$(du -h /sys/class/power_supply/* | grep "BAT*")

# Exit if there are no batteries
if [ -z "$BATTERY" ]; then
    exit 0
fi

# Store block update commands in a function
UPDATE_BLOCK() { \
    pkill -SIGRTMIN+4 dwmblocks || pkill -SIGRTMIN+4 i3blocks
	}

# Mouse actions
case $BLOCK_BUTTON in
    1) xbacklight -set 60 && UPDATE_BLOCK ;;
    3) xbacklight -set 20 && UPDATE_BLOCK ;;
    4) xbacklight -inc 10 && UPDATE_BLOCK ;;
    5) xbacklight -dec 10 && UPDATE_BLOCK ;;
esac

# Argument actions
case $1 in
    high) xbacklight -set 60 && UPDATE_BLOCK ;;
    low) xbacklight -set 20 && UPDATE_BLOCK ;;
    up) xbacklight -inc 10 && UPDATE_BLOCK ;;
    down) xbacklight -dec 10 && UPDATE_BLOCK ;;
esac

# Print the current brightness level
BRIGHTNESS=$(xbacklight -get)
printf "ïƒ« $BRIGHTNESS%%\n"
