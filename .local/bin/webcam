#!/bin/sh

# Store present webcams in variables
external_webcam=$(du /dev/video* | awk '{print $2}' | grep '2')
integrated_webcam=$(du /dev/video* | awk '{print $2}' | grep '0')

# If the external webcam is connected, open that
if [ ! -z "$external_webcam" ]; then
    setsid -f mpv --profile=low-latency --untimed -v av://v4l2:/dev/video2 &
    exit 0
# If not, open the integrated one
elif [ ! -z "$integrated_webcam" ]; then
    setsid -f mpv --profile=low-latency --untimed -v av://v4l2:/dev/video0 &
    exit 0
# Else, print error message and exit
else
    tput setaf 1; printf "No webcams found. Exiting...\n"; tput sgr0
    exit 1
fi
